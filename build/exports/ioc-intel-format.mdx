---
title: "IOC intelligence export format"
description: "Schema and field reference for the IOC (indicator of compromise) bulk export"
---

# IOC Intelligence Export Models Documentation


**Version:** 1.0.0
**Description:** IOC (Indicator of Compromise) Intelligence Export Models Documentation

## Version History

- **1.0.0**: Initial release. Exports observables with opinions filtered by verdict. Includes reference URL and source_slug for provenance tracking. Supports optional type_filter parameter.

## Additional Materials

For additional materials including the complete JSON schema, API documentation, and integration examples, please contact **hello@mallory.ai**.

---

## Table of Contents

- [Export Record Format](#export-record-format)
- [Export Models](#export-models)
  - [Observable](#observable)
  - [Opinion](#opinion)
- [Examples](#examples)

## Export Record Format

**The main export format for IOC intelligence data.**

**Export Name:** `ioc_intel_record`
**Version:** `1.0.0`
**Description:** Complete IOC intelligence record with observable and opinions

Each line in the JSONL export contains a complete observable record with all related opinions:

```jsonl
{"uuid": "...", "observable": {...}, "opinions": [...], "verdict_summary": {...}}
{"uuid": "...", "observable": {...}, "opinions": [...], "verdict_summary": {...}}
```

### Export Record Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `uuid` | `string` | ✅ | Unique identifier for this record |
| `created_at` | `string` | ✅ | When this record was first created in the system |
| `updated_at` | `string` | ✅ | When this record was last updated in the system |
| `observable` | `object` | ✅ | The observable (IOC) data |
| `opinions` | `array[object]` |  | List of opinions about this observable from various sources |
| `verdict_summary` | `object` |  | Summary of verdicts across all opinions (e.g., {'malicious': 3, 'suspicious': 1}) |
| `source_count` | `integer` |  | Number of unique sources with opinions on this observable |
| `first_seen_at` | `string` |  | Earliest published_at timestamp across all opinions (ISO format) |
| `last_seen_at` | `string` |  | Latest published_at timestamp across all opinions (ISO format) |

### Export Models

The following models represent the individual components that make up the complete export record:

#### Observable

**Export Name:** `ioc_intel_observable`
**Version:** `1.0.0`
**Description:** Observable (IOC) data for IOC intelligence export

##### Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `uuid` | `string` | ✅ | Unique identifier for this observable |
| `type` | `string` | ✅ | Type of observable (e.g., 'ip.v4', 'ip.v6', 'domain', 'uri', 'hash.md5', 'hash.sha1', 'hash.sha256') |
| `name` | `string` | ✅ | The observable value (normalized) |
| `description` | `string` |  | Optional description of the observable |
| `attributes` | `object` |  | Additional attributes associated with the observable |
| `created_at` | `string` | ✅ | When this observable was first created in the system |
| `updated_at` | `string` | ✅ | When this observable was last updated in the system |

##### Summary

- **Total Fields:** 7
- **Required Fields:** 5
- **Optional Fields:** 2

#### Opinion

**Export Name:** `ioc_intel_opinion`
**Version:** `1.0.0`
**Description:** Opinion data for IOC intelligence export

##### Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `uuid` | `string` | ✅ | Unique identifier for this opinion |
| `verdict` | `string` |  | Opinion verdict: 'malicious', 'suspicious', 'benign', or 'unknown' |
| `source` | `string` | ✅ | Source of the opinion (typically the source slug) |
| `confidence` | `string` |  | Confidence level: 'low', 'medium', or 'high' |
| `description` | `string` |  | Description or context for the opinion |
| `attributes` | `object` |  | Additional attributes from the opinion source |
| `reference_url` | `string` |  | Original URL where this opinion was published |
| `reference_source_slug` | `string` |  | Source slug of the reference (content source identifier) |
| `reference_uuid` | `string` |  | UUID of the associated reference in Mallory |
| `published_at` | `string` | ✅ | When this opinion was published by the source |
| `created_at` | `string` | ✅ | When this opinion was first created in Mallory |
| `updated_at` | `string` | ✅ | When this opinion was last updated in Mallory |

##### Summary

- **Total Fields:** 12
- **Required Fields:** 5
- **Optional Fields:** 7

## Examples

Below are complete example records showing the structure and content of each export model:

### Complete Export Record

A complete IOC intelligence record with observable and opinions:

```json
{
  "uuid": "550e8400-e29b-41d4-a716-446655440000",
  "created_at": "2024-06-15T10:30:00+00:00",
  "updated_at": "2024-06-20T14:00:00+00:00",
  "observable": {
    "uuid": "550e8400-e29b-41d4-a716-446655440000",
    "type": "ip.v4",
    "name": "192.168.1.100",
    "description": "Suspicious C2 endpoint from threat report",
    "attributes": null,
    "created_at": "2024-06-15T10:30:00+00:00",
    "updated_at": "2024-06-20T14:00:00+00:00"
  },
  "opinions": [
    {
      "uuid": "660e8400-e29b-41d4-a716-446655440001",
      "verdict": "malicious",
      "source": "abuse_ch_urlhaus",
      "confidence": "high",
      "description": "Listed on URLhaus as malicious host",
      "attributes": null,
      "reference_url": "https://urlhaus.abuse.ch/host/192.168.1.100/",
      "reference_source_slug": "abuse_ch_urlhaus",
      "reference_uuid": "770e8400-e29b-41d4-a716-446655440002",
      "published_at": "2024-06-18T12:00:00+00:00",
      "created_at": "2024-06-15T10:30:00+00:00",
      "updated_at": "2024-06-20T14:00:00+00:00"
    }
  ],
  "verdict_summary": {
    "malicious": 1,
    "suspicious": 0
  },
  "source_count": 1,
  "first_seen_at": "2024-06-18T12:00:00+00:00",
  "last_seen_at": "2024-06-18T12:00:00+00:00"
}
```

### Observable Example

```json
{
  "uuid": "550e8400-e29b-41d4-a716-446655440000",
  "type": "ip.v4",
  "name": "192.168.1.100",
  "description": "Suspicious C2 endpoint from threat report",
  "attributes": null,
  "created_at": "2024-06-15T10:30:00+00:00",
  "updated_at": "2024-06-20T14:00:00+00:00"
}
```

### Opinion Example

```json
{
  "uuid": "660e8400-e29b-41d4-a716-446655440001",
  "verdict": "malicious",
  "source": "abuse_ch_urlhaus",
  "confidence": "high",
  "description": "Listed on URLhaus as malicious host",
  "attributes": null,
  "reference_url": "https://urlhaus.abuse.ch/host/192.168.1.100/",
  "reference_source_slug": "abuse_ch_urlhaus",
  "reference_uuid": "770e8400-e29b-41d4-a716-446655440002",
  "published_at": "2024-06-18T12:00:00+00:00",
  "created_at": "2024-06-15T10:30:00+00:00",
  "updated_at": "2024-06-20T14:00:00+00:00"
}
```
